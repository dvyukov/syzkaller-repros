// KASAN: slab-out-of-bounds Read in pfkey_compile_policy
// https://syzkaller.appspot.com/bug?id=4f9a1ddf075217bc3801a46a008f8c70f1b7399f
// status:invalid
// autogenerated by syzkaller (http://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <sys/syscall.h>
#include <unistd.h>

#include <stdint.h>
#include <string.h>

#ifndef __NR_mmap
#define __NR_mmap 192
#endif
#ifndef __NR_socket
#define __NR_socket 359
#endif
#ifndef __NR_setsockopt
#define __NR_setsockopt 366
#endif
#undef __NR_mmap
#define __NR_mmap __NR_mmap2

long r[1];
void loop()
{
  memset(r, -1, sizeof(r));
  syscall(__NR_mmap, 0x20000000ul, 0xeed000ul, 0x3ul, 0x32ul,
          0xfffffffffffffffful, 0x0ul);
  r[0] = syscall(__NR_socket, 0x2ul, 0x1ul, 0x0ul);
  memcpy((void*)0x20a2ff3e,
         "\x02\x00\x00\x00\x02\x00\x01\x00\x00\x00\xbe\x8c\x5e\xe1\x8c"
         "\x88\xa1\x00\x01\x00\x00\x00\x00\x05\x01\xda\xfd\x02\xa3\x8a"
         "\x3c\xdc\xf7\xb9\x33\xd8\x98\x05\x55\xf7\x48\x52\xbb\x6a\x88"
         "\x07\x56\x7f\x59\xdb\xa6\x7e\x21\x47\xb3\x55\x04\x00\x6f\xcd"
         "\x67\x01\xe2\x01\x00\x67\x2f\x21\x63\xe0\x20\x9c\xee\x4a\x5a"
         "\xcb\x3d\xa4\x83\xf0\xa4\xcf\x97\xe1\x70\xb6\xc8\x8e\xbb\xff"
         "\x06\x01\x00\x00\x00\x01\x00\x00\x00\xb1\x21\xec\x14\x74\xd7"
         "\x10\xf5\x42\x50\x6b\x00\xec\x00\x8b\xc5\xcf\xb7\xb3\xe7\xec"
         "\x08\xe8\x7c\xcc\xff\xf6\xba\x00\x00\x00\x02\x4f\x02\x98\xe9"
         "\xe9\xf5\x54\x06\xaa\x10\xdd\xfd\xff\x03\x6a\x00\x00\x00\x00"
         "\xd7\x91\xa2\xff\xe3\xc5\x73\x2c\x1a\xdb\x8a\xfc\x5b\xd8\xc2"
         "\xd1\x7f\xde\xa2\x1b\x54\x10\x68\x39\x3d\x22\xb5\xaf\xfa\x00"
         "\x04\x1a\xd0\xd2\xc0\x3e\xef\x67\x95\xde\x42\xe3\x84\x9b",
         194);
  syscall(__NR_setsockopt, r[0], 0x0ul, 0x10ul, 0x20a2ff3eul, 0xc2ul);
}

int main()
{
  loop();
  return 0;
}
