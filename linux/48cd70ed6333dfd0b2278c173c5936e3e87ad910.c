// panic: runtime error: index out of range
// https://syzkaller.appspot.com/bug?id=48cd70ed6333dfd0b2278c173c5936e3e87ad910
// status:fixed
// autogenerated by syzkaller (http://github.com/google/syzkaller)

#define _GNU_SOURCE
#include <endian.h>
#include <stdint.h>
#include <string.h>
#include <sys/syscall.h>
#include <unistd.h>

uint64_t r[2] = {0xffffffffffffffff, 0xffffffffffffffff};
void loop()
{
  long res = 0;
  res = syscall(__NR_socket, 1, 1, 0);
  if (res != -1)
    r[0] = res;
  *(uint16_t*)0x20000000 = 1;
  memcpy((void*)0x20000002,
         "\x3e\x45\x01\x14\x4d\x85\x04\x26\xc2\x0f\xef\x86\xbe\xa2\x5a\x1f\xb8"
         "\xd3\x4d\xa3\x44\xb1\x69\xa6\xce\x61\x05\xae\x50\x39\x73\x16\xf9\x2b"
         "\x14\xa1\x64\xaa\x04\x2d\xe5\x63\x4a\xd7\x45\x90\x6e\xc1\xbc\x81\x22"
         "\x6e\x2e\x95\x51\xc4\x59\xcc\xaa\xcf\x34\x82\x3c\x73\xbf\xbd\x79\x1e"
         "\x5b\xb9\x94\xa9\x0a\x33\xed\xda\xad\xaa\x5d\x6b\x0b\xdb\xdc\x98\xec"
         "\x14\x6e\x79\xaa\xf9\xe0\xd6\xec\xb5\x8c\x0d\x4e\x0a\x9e\xad\x99\xb6"
         "\xa1\x83\x43\x5f\x6c\x17\x92\x4c\xbe\xc1\x64\x49\xea\xeb\x04\xd6\x7a"
         "\xba\x29\x9a\x13\x63\xde\xe7",
         126);
  syscall(__NR_bind, r[0], 0x20000000, 0x80);
  res = syscall(__NR_socket, 1, 1, 0);
  if (res != -1)
    r[1] = res;
  *(uint16_t*)0x20003000 = 1;
  memcpy((void*)0x20003002,
         "\xe9\x1f\x71\x89\x59\x1e\x92\x33\x61\x4b\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00",
         108);
  syscall(__NR_bind, r[1], 0x20003000, 0xc);
  syscall(__NR_listen, r[1], 0);
  *(uint16_t*)0x20932000 = 1;
  memcpy((void*)0x20932002,
         "\xe9\x1f\x71\x89\x59\x1e\x92\x33\x61\x4b\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
         "\x00\x00\x00\x00\x00\x00",
         108);
  syscall(__NR_connect, r[0], 0x20932000, 0xc);
  *(uint32_t*)0x20b3f000 = 0;
  syscall(__NR_accept, r[1], 0, 0x20b3f000);
}

int main()
{
  syscall(__NR_mmap, 0x20000000, 0x1000000, 3, 0x32, -1, 0);
  loop();
  return 0;
}
