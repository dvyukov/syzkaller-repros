// general protection fault in fib_dump_info
// https://syzkaller.appspot.com/bug?id=ff3b27c5a26a52454b64fec53964965077f9696c
// status:fixed
// autogenerated by syzkaller (http://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <stdint.h>
#include <string.h>
#include <sys/syscall.h>
#include <unistd.h>

long r[6];
void loop()
{
  memset(r, -1, sizeof(r));
  r[0] = syscall(__NR_mmap, 0x20000000ul, 0xb9c000ul, 0x3ul, 0x32ul,
                 0xfffffffffffffffful, 0x0ul);
  r[1] = syscall(__NR_socket, 0x10ul, 0x3ul, 0x0ul);
  *(uint64_t*)0x20b93000 = (uint64_t)0x20b9b000;
  *(uint64_t*)0x20b93008 = (uint64_t)0x2a;
  memcpy((void*)0x20b9b000,
         "\x29\x00\x00\x00\x1a\x00\x15\xa8\x6b\x3d\x75\x9e\xef\xad\x00"
         "\xf7\x02\x00\x8d\x99\x00\xff\x01\x07\x00\xe3\xff\x00\x09\x00"
         "\x10\x00\x00\x00\x00\x00\x11\x00\x00\x7f\xf7\x39",
         42);
  r[5] = syscall(__NR_writev, r[1], 0x20b93000ul, 0x1ul);
}

int main()
{
  loop();
  return 0;
}
