// UBSAN: undefined-behaviour in tcf_police_init
// https://syzkaller.appspot.com/bug?id=dea15950ad33192f1733
// status:0
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
  syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
  syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
  syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
  intptr_t res = 0;
  *(uint64_t*)0x20000300 = 0;
  *(uint32_t*)0x20000308 = 0;
  *(uint64_t*)0x20000310 = 0x20000000;
  *(uint64_t*)0x20000000 = 0x20000480;
  memcpy(
      (void*)0x20000480,
      "\xa0\x10\x00\x00\x30\x00\x3d\xeb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x8c\x10\x01\x00\x88\x10\x01\x00\x0b\x00\x01\x00\x70\x6f\x6c\x69"
      "\x63\x65\x00\x00\x58\x10\x02\x80\x04\x04\x02\x00\x00\x04\x00\x00\x03\x00"
      "\x00\x00\x01\x80\x00\x00\x07\x00\x00\x00\x08\x00\x00\x00\x02\x00\x00\x00"
      "\x00\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\x00"
      "\x00\x00\x00\x00\x00\x00\x01\x04\x00\x00\xfb\xff\xff\xff\x00\x00\x00\x00"
      "\x00\x10\x00\x00\x01\x01\x00\x00\xff\xff\x00\x00\x01\x00\x00\x00\x07\x00"
      "\x00\x00\x09\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x07\x00\x00\x00"
      "\x06\x00\x00\x00\x02\x00\x00\x00\x1f\x00\x00\x00\x7f\x00\x00\x00\x00\xb6"
      "\xf6\x00\x05\x00\x00\x00\x04\x00\x00\x00\xff\x63\xff\xff\x06\x00\x00\x00"
      "\x08\x00\x00\x00\x05\x00\x00\x00\x05\x00\x00\x00\x07\x00\x00\x00\x80\x00"
      "\x00\x00\xff\x00\x00\x00\x08\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x02\x00\x00\x00\x18\x03\x00\x00\x01\x00\x00\x00\x00\x00"
      "\x00\x00\x07\x00\x00\x00\x06\x00\x00\x00\x08\x00\x00\x00\x09\x00\x00\x00"
      "\x07\x00\x00\x00\x02\x00\x00\x00\x07\x00\x00\x00\x09\x00\x00\x00\xff\xff"
      "\xff\xff\x07\x00\x00\x00\x01\x04\x00\x00\x00\x00\x00\x80\xe7\x10\x00\x00"
      "\x1f\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\xff\xff"
      "\xff\xff\x03\x00\x00\x00\x07\x00\x00\x00\x6f\x23\x00\x00\x07\x00\x00\x00"
      "\x00\x00\x00\x00\xff\x07\x00\x00\x09\x00\x00\x00\x05\x00\x00\x00\x01\x00"
      "\x00\x00\x05\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x80\x81\x00\x00\x00"
      "\x00\x00\x00\x00\x1f\x00\x00\x00\x00\x00\x00\x80\x06\x00\x00\x00\xff\x7f"
      "\x00\x00\x01\x00\x00\x00\x3f\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00"
      "\x02\x00\x00\x00\x09\x00\x00\x00\x40\x00\x00\x00\x6b\xca\x2d\x07\x2f\x07"
      "\x00\x00\x06\x00\x00\x00\x09\x00\x00\x00\x08\x00\x00\x00\xd1\xb2\x00\x00"
      "\xad\x0a\x00\x00\x06\x00\x00\x00\x06\x00\x00\x00\x06\x00\x00\x00\x7f\x00"
      "\x00\x00\x81\x00\x00\x00\x47\x00\x00\x00\xff\x00\x00\x00\xe6\xc1\x93\x9a"
      "\xff\xff\x00\x00\x01\x00\x00\x00\xf7\x05\x00\x00\xff\xff\x00\x00\x09\x00"
      "\x00\x00\xaa\x00\x00\x00\x18\x02\x00\x00\x07\x00\x00\x00\x01\x80\x00\x00"
      "\xa7\x23\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x07\x00\x00\x00\x01\x00"
      "\x00\x00\x02\x00\x00\x00\x06\x00\x00\x00\xf7\xff\xff\xff\x02\x00\x00\x00"
      "\xff\x01\x00\x00\x2d\x00\x00\x00\x06\x00\x00\x00\x7f\x00\x00\x00\x09\x00"
      "\x00\x00\xa0\x0b\x00\x00\x04\x00\x00\x00\xfe\xff\xff\xff\x3f\x00\x00\x00"
      "\x04\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x78\x0a\x00\x00\x3f\x00"
      "\x00\x00\xd6\x59\x00\x00\x07\x00\x00\x00\x00\x04\x00\x00\xdc\x75\x00\x00"
      "\x09\x00\x00\x00\x83\x00\x00\x00\x73\x4f\x00\x00\x00\x00\x00\x00\x05\x00"
      "\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x07\x00\x00\x00\x17\x00\x00\x00"
      "\x07\x00\x00\x00\x29\x00\x00\x00\x80\x00\x00\x00\x07\x00\x00\x00\x00\x08"
      "\x00\x00\x8c\xcc\x00\x00\x07\x00\x00\x00\xff\x0f\x00\x00\x00\x10\x00\x00"
      "\x03\x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00\x40\x00"
      "\x00\x00\x04\x02\x00\x00\x79\xd6\x00\x00\xff\x7f\x00\x00\x09\x00\x00\x00"
      "\x1f\x00\x00\x00\xff\xff\xff\x7f\x08\x00\x00\x00\x00\x00\x00\x00\x6b\x00"
      "\x00\x00\x1f\x00\x00\x00\x06\x00\x00\x00\x08\x00\x00\x00\x02\x00\x00\x00"
      "\x07\x00\x00\x00\xa5\x05\x00\x00\x8d\x88\x00\x00\x06\x00\x00\x00\x01\x00"
      "\x00\x00\x03\x00\x00\x00\x25\xb5\x00\x00\x06\x00\x00\x00\x00\x04\x00\x00"
      "\xff\xff\xff\x7f\x04\x00\x00\x00\x09\x00\x00\x00\x02\x00\x00\x00\x00\x00"
      "\x00\x81\x00\x00\x00\x00\xff\x7f\x00\x00\xff\xff\xff\xff\x04\x00\x00\x00"
      "\x07\x00\x00\x00\x30\x00\x00\x00\x00\x01\x00\x00\xff\x07\x00\x00\x01\x00"
      "\x00\x00\x04\x00\x00\x00\x04\x00\x00\x00\x00\x88\x00\x00\x00\x00\x01\x00"
      "\x08\x00\x00\x00\x04\x00\x00\x00\x20\x00\x00\x00\x03\x00\x00\x00\x05\x00"
      "\x00\x00\x00\x01\x00\x00\x03\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00"
      "\x03\x00\x00\x00\x00\x02\x00\x00\x07\x00\x00\x00\x03\x00\x00\x00\x04\x00"
      "\x00\x00\xf7\xff\xff\xff\x05\x00\x00\x00\xb3\x00\x00\x00\x05\x00\x00\x00"
      "\x07\x00\x00\x00\x07\x00\x00\x00\x82\xc6\x00\x00\x08\x00\x00\x00\x05\x00"
      "\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00"
      "\x41\xa5\x00\x00\x02\x00\x00\x00\x46\x00\xff\x71\x06\x00\x00\x00\xc3\x00"
      "\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x08\x00\x00\x00"
      "\x07\x00\x00\x00\x81\x00\x00\x00\x67\xee\x00\x00\x08\x00\x00\x00\x9f\x7b"
      "\x7e\x2a\x01\x01\x00\x00\xa3\x0e\x00\x00\xd5\x80\x00\x00\x07\x00\x00\x00"
      "\x08\x00\x00\x00\x40\x00\x00\x00\x03\x00\x00\x00\xfd\x00\x00\x00\x04\x59"
      "\x00\x00\x08\x00\x04\x00\x00\x00\x00\x00\x3c\x00\x01",
      1075);
  *(uint64_t*)0x20000008 = 0x10a0;
  *(uint64_t*)0x20000318 = 1;
  *(uint64_t*)0x20000320 = 0;
  *(uint64_t*)0x20000328 = 0;
  *(uint32_t*)0x20000330 = 0;
  syscall(__NR_sendmsg, -1, 0x20000300ul, 0ul);
  res = syscall(__NR_socket, 0x1000000010ul, 0x80002ul, 0);
  if (res != -1)
    r[0] = res;
  *(uint64_t*)0x20000140 = 0;
  *(uint32_t*)0x20000148 = 0;
  *(uint64_t*)0x20000150 = 0x20000100;
  *(uint64_t*)0x20000100 = 0x200008c0;
  *(uint32_t*)0x200008c0 = 0x14;
  *(uint16_t*)0x200008c4 = 0;
  *(uint16_t*)0x200008c6 = 0;
  *(uint32_t*)0x200008c8 = 0x70bd2d;
  *(uint32_t*)0x200008cc = 0;
  *(uint8_t*)0x200008d0 = 4;
  *(uint8_t*)0x200008d1 = 0;
  *(uint16_t*)0x200008d2 = 0;
  *(uint64_t*)0x20000108 = 0x14;
  *(uint64_t*)0x20000158 = 1;
  *(uint64_t*)0x20000160 = 0;
  *(uint64_t*)0x20000168 = 0;
  *(uint32_t*)0x20000170 = 0;
  syscall(__NR_sendmsg, -1, 0x20000140ul, 0ul);
  syscall(__NR_sendmmsg, r[0], 0x20000200ul, 0x10efe10675dec16ul, 0ul);
  return 0;
}
