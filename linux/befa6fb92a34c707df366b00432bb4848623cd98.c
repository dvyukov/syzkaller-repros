// general protection fault in nf_tables_dump_obj_done
// https://syzkaller.appspot.com/bug?id=befa6fb92a34c707df366b00432bb4848623cd98
// status:fixed
// autogenerated by syzkaller (http://github.com/google/syzkaller)

#define _GNU_SOURCE
#include <endian.h>
#include <stdint.h>
#include <string.h>
#include <sys/syscall.h>
#include <unistd.h>

long r[1];
void loop()
{
  memset(r, -1, sizeof(r));
  syscall(__NR_mmap, 0x20000000, 0xfff000, 3, 0x32, -1, 0);
  r[0] = syscall(__NR_socket, 0x200000000010, 2, 0xc);
  memcpy((void*)0x20a35000,
         "\x1f\x00\x00\x00\x13\x0a\xff\x01\x14\x43\x45\xc0\x06\x2e\x00\x00\x02"
         "\x05\x81\x05\x08\xec\x00\x00\x01\x00\xe6\x00\xdf\x00\xd0\x27\x40\xd9"
         "\x81\x8a\x89\xd0\x4e\xc0\xd5\x6a\xcf\x7c\x80\xdc\x6d\x92\x28\x07\xa8"
         "\x47\xa0\x4d\x10\xc9\x74\x49\x19\x83\x4d\x44\x7a\xf8\x84\x16\x54\x79"
         "\x87\xec\xb5\x41\x10\x28\xbf\x12\x6a\x47\x0c\xe9\x5b\x5b\x10\x2d\xb9"
         "\x3d\xf9\xfa\xb4\x14\xa2\x9a\x09\x9f\x03\x63\x6a\x0f\x51\xa2\x29\x80"
         "\x7b\x34\xc7\xd9\xb9\xfb\x1e\x29\x90\x33\xd5\x2d\x79\x5b\x81\xbb\x1c"
         "\x9c\xa7\x4e\x75\x99\x6e\x04\x13\xb0\x9c\x6c\xfa\x6a\xd1\xbe\x57\x61"
         "\xf3\x62\x5a\xf8\x04\x00\x00\x00\x06\x6a\x00\x54\x25\xea\xf5\x31\xb1"
         "\x71\x76\x97",
         156);
  syscall(__NR_write, r[0], 0x20a35000, 0x9c);
}

int main()
{
  loop();
  return 0;
}
